<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unit Tests</title>
    <link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.20.0.css">
    <script src="//code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script src="../cookies.js"></script>
    <script src="../persona.js"></script>
    <script src="../login.js"></script>
    <script src="../index.js"></script>
</head>
<body>

<script src="//code.jquery.com/qunit/qunit-1.20.0.js"></script>
<script>
    QUnit.module("Name spacing");
    QUnit.test("APP exists", function (assert) {
        var typeIs = typeof APP;
        assert.ok(typeIs !== 'undefined' && typeIs === 'object', "APP should be defined");
    });
    QUnit.test("Expected objects within APP", function (assert) {
        var typeIs = typeof APP.cookies;
        assert.ok(typeIs !== 'undefined' && typeIs === 'object', "APP.cookies should be defined");
        typeIs = typeof APP.persona;
        assert.ok(typeIs !== 'undefined' && typeIs === 'object', "APP.persona should be defined");
    });
    QUnit.test("Expected functions within APP", function (assert) {
        var typeIs = typeof APP.Login;
        assert.ok(typeIs !== 'undefined' && typeIs === 'function', "APP.Login should be defined");
        typeIs = typeof APP.Home;
        assert.ok(typeIs !== 'undefined' && typeIs === 'function', "APP.Home should be defined");
    });
    QUnit.module("Cookies");
    QUnit.test("Test get/set cookie", function (assert) {
        var key = "foo";
        var value = "bar";
        APP.cookies.set(key, value);
        assert.equal(APP.cookies.get(key), value);
    });
    QUnit.module("Login");
    QUnit.test("Test button default disabled", function (assert) {
        var login = new APP.Login();
        assert.ok($('#personaButton').prop('disabled'));
    });
    QUnit.test("Test valid email enables.", function (assert) {
        var login = new APP.Login();
        var email = "foo@bar.com";
        var username = $('#username');
        username.val(email);
        login.enablePersona();
        assert.ok(!$('#personaButton').prop('disabled'));
    });
</script>
</body>
<div id="qunit"></div>
<div id="qunit-fixture">
    <!-- Login UI mockup -->
    <input size="20" id="username" type="text">
    <input size="20" id="password" type="password">
    <button id="personaButton" >Login With Persona</button>

    <!-- index.html -->
</div>
</html>
